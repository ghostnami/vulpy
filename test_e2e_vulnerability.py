#!/usr/bin/env python3
"""
ðŸš¨ E2E TEST VULNERABILITY FOR APPSECINABOX
This file contains intentional vulnerabilities to test the full webhookâ†’analysisâ†’comment flow.
"""

import os
import subprocess
import base64

# ðŸš¨ Hardcoded credentials
DATABASE_PASSWORD = "super_secret_password_123!"
API_KEY = "sk-live-abcdef1234567890"
AWS_SECRET = "AKIAEXAMPLEKEY123456"

def vulnerable_function(user_input):
      # ðŸš¨ SQL Injection vulnerability
      query = f"SELECT * FROM users WHERE name='{user_input}' AND password='{DATABASE_PASSWORD}'"
      print(f"Executing query: {query}")

    # ðŸš¨ Command injection
      os.system(f"echo 'Processing {user_input}'")

    # ðŸš¨ Information disclosure
      print(f"Database password: {DATABASE_PASSWORD}")
      print(f"API key: {API_KEY}")

    return "Vulnerable function executed"

if __name__ == "__main__":
      vulnerable_function("admin")
